<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boter, Kaas en Eieren: Lesstof Editie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* gray-900 */
            color: #d1d5db; /* gray-300 */
        }
        .board-cell {
            transition: all 0.2s ease-in-out;
            background-color: #1f2937; /* gray-800 */
            border: 2px solid #374151; /* gray-700 */
        }
        .board-cell:hover:not(.occupied) {
            background-color: #374151; /* gray-700 */
        }
        .x-symbol, .o-symbol {
            font-weight: bold;
            font-size: clamp(2rem, 12vw, 4.5rem); /* Responsive font size */
            line-height: 1; /* Prevent extra vertical space */
        }
        .x-symbol {
            color: #22d3ee; /* cyan-400 */
            text-shadow: 0 0 10px rgba(34, 211, 238, 0.7);
        }
        .o-symbol {
            color: #f87171; /* red-400 */
            text-shadow: 0 0 10px rgba(248, 113, 113, 0.7);
        }
        .modal {
            display: none;
        }
        .modal.active {
            display: flex;
        }
        .main-btn {
            background-color: #22d3ee;
            color: #111827;
            font-weight: bold;
            border-radius: 9999px;
            padding: 0.75rem 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.5);
        }
        .main-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(34, 211, 238, 0.8);
        }
        .title-glow {
            color: #22d3ee;
            text-shadow: 0 0 15px rgba(34, 211, 238, 0.8);
        }
        .winning-cell {
            animation: glow 1s infinite alternate;
            background-color: #22c55e; /* green-500 */
            border-color: #86efac; /* green-300 */
        }
        details > summary {
            list-style: none;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details > summary .arrow {
            transition: transform 0.2s;
        }
        details[open] > summary .arrow {
            transform: rotate(90deg);
        }
        @keyframes glow {
            from {
                box-shadow: 0 0 5px #22c55e;
            }
            to {
                box-shadow: 0 0 20px #86efac, 0 0 30px #22c55e;
            }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

    <!-- Video Intro Screen -->
    <div id="video-intro-screen" class="fixed inset-0 bg-black flex flex-col items-center justify-center z-50">
        <video id="intro-video" class="w-full h-full object-cover" autoplay muted playsinline>
            <source src="Video_Intro_Boter_Kaas_en_Eieren.mp4" type="video/mp4">
            Je browser ondersteunt de video tag niet.
        </video>
        <button id="skip-intro-btn" class="absolute bottom-10 main-btn bg-gray-800 bg-opacity-70 text-white shadow-none hover:bg-gray-700">Intro overslaan</button>
    </div>

    <div id="game-container" class="hidden w-full max-w-4xl mx-auto p-4 md:p-6">
        
        <!-- Setup Screen -->
        <div id="setup-screen" class="bg-[#1f2937] p-8 rounded-lg shadow-2xl text-center">
            <h1 class="text-5xl md:text-6xl font-black mb-2 title-glow">Boter, Kaas en Eieren</h1>
            <h2 class="text-xl md:text-2xl font-bold text-cyan-500 mb-2">Geschiedenis Editie</h2>
            <p class="text-gray-500 text-sm mb-6">(Gebaseerd op MEMO Max)</p>
            <p class="text-gray-400 mb-8">Voer de teamnamen in en kies de onderwerpen om het spel te starten.</p>
            <div class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="team-blue-name" class="block text-left font-semibold text-cyan-400 mb-2">Team Blauw (X)</label>
                        <input type="text" id="team-blue-name" class="w-full p-3 bg-gray-700 border-2 border-gray-600 rounded-md text-white focus:border-cyan-400 focus:ring-0" placeholder="Vul hier je teamnaam in">
                    </div>
                    <div>
                        <label for="team-red-name" class="block text-left font-semibold text-red-400 mb-2">Team Rood (O)</label>
                        <input type="text" id="team-red-name" class="w-full p-3 bg-gray-700 border-2 border-gray-600 rounded-md text-white focus:border-red-400 focus:ring-0" placeholder="Vul hier je teamnaam in">
                    </div>
                </div>
                
                <div class="my-6 text-left">
                    <h3 class="font-semibold text-xl mb-4 text-center">Kies de onderwerpen</h3>
                    
                    <!-- Mavo 3 Section -->
                    <details class="bg-gray-800 rounded-lg border-2 border-gray-700 mb-3">
                        <summary class="p-4 font-semibold text-lg cursor-pointer flex justify-between items-center">
                            Mavo 3
                            <svg class="arrow w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </summary>
                        <div id="topic-selection-mavo3" class="grid grid-cols-2 sm:grid-cols-3 gap-3 p-4 border-t border-gray-700">
                           <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="3-1.3" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.3 Nationalisme</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="3-1.4" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.4 Dekolonisatie</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="3-2.1" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§2.1 Revolutie</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="3-2.2" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§2.2 Samenleving</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="3-2.3" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§2.3 Industrie</span>
                            </label>
                        </div>
                    </details>
                    
                    <!-- Mavo 4 Section -->
                     <details class="bg-gray-800 rounded-lg border-2 border-gray-700">
                        <summary class="p-4 font-semibold text-lg cursor-pointer flex justify-between items-center">
                            Mavo 4
                             <svg class="arrow w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </summary>
                        <div id="topic-selection-mavo4" class="grid grid-cols-2 sm:grid-cols-3 gap-3 p-4 border-t border-gray-700">
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="4-1.1" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.1 Koning & Parlement</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="4-1.2" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.2 Politieke Stromingen</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="4-1.3" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.3 Sociale Wetten & Kiesrecht</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="4-1.4" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>§1.4 Parlement & Democratie</span>
                            </label>
                             <label class="flex items-center space-x-3 p-3 bg-gray-900 border-2 border-gray-600 rounded-md cursor-pointer hover:bg-gray-700 transition-colors">
                                <input type="checkbox" name="topic" value="4-personen" class="rounded h-5 w-5 bg-gray-600 border-gray-500 text-cyan-400 focus:ring-cyan-500 focus:ring-offset-gray-800">
                                <span>Personen</span>
                            </label>
                        </div>
                    </details>
                    
                    <p id="topic-error" class="text-red-400 mt-2 h-4 text-center"></p>
                </div>

                <button id="start-game-btn" class="main-btn w-full md:w-auto">Start Spel</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden">
             <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                <div id="player-blue-display" class="p-3 rounded-lg font-bold text-lg text-white bg-cyan-600 bg-opacity-80 w-full md:w-auto text-center shadow-lg">Speler X: </div>
                <div id="turn-indicator" class="p-3 rounded-lg font-bold text-lg bg-gray-800 shadow-md w-full md:w-auto text-center order-first md:order-none">... is aan de beurt</div>
                <div id="player-red-display" class="p-3 rounded-lg font-bold text-lg text-white bg-red-600 bg-opacity-80 w-full md:w-auto text-center shadow-lg">Speler O: </div>
            </div>
            <div id="game-board" class="grid grid-cols-3 gap-3 max-w-xl mx-auto p-3 rounded-lg shadow-2xl">
                <!-- Cells will be generated by JS -->
            </div>
             <div id="result-display" class="hidden mt-6 text-center">
                <h2 id="result-message" class="text-4xl font-bold title-glow"></h2>
                <button id="play-again-btn" class="mt-6 main-btn">Opnieuw Spelen</button>
            </div>
        </div>
    </div>

    <!-- Question Modal -->
    <div id="question-modal" class="modal fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm items-center justify-center p-4">
        <div class="bg-gray-800 rounded-lg shadow-2xl p-8 max-w-2xl w-full border-2 border-gray-700">
            <h2 class="text-2xl font-bold mb-2 text-cyan-400">Vraag</h2>
            <p id="question-text" class="text-gray-300 mb-6 text-lg"></p>
            <div id="answer-options" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Answer buttons will be generated by JS -->
            </div>
            <div id="feedback-message" class="mt-6 font-bold text-center text-xl h-6"></div>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const videoIntroScreen = document.getElementById('video-intro-screen');
        const introVideo = document.getElementById('intro-video');
        const skipIntroBtn = document.getElementById('skip-intro-btn');
        const gameContainer = document.getElementById('game-container');

        const setupScreen = document.getElementById('setup-screen');
        const gameScreen = document.getElementById('game-screen');
        const startGameBtn = document.getElementById('start-game-btn');
        const teamBlueNameInput = document.getElementById('team-blue-name');
        const teamRedNameInput = document.getElementById('team-red-name');
        const topicError = document.getElementById('topic-error');
        
        const playerBlueDisplay = document.getElementById('player-blue-display');
        const playerRedDisplay = document.getElementById('player-red-display');
        const turnIndicator = document.getElementById('turn-indicator');
        const gameBoard = document.getElementById('game-board');
        const resultDisplay = document.getElementById('result-display');
        const resultMessage = document.getElementById('result-message');
        const playAgainBtn = document.getElementById('play-again-btn');

        const questionModal = document.getElementById('question-modal');
        const questionText = document.getElementById('question-text');
        const answerOptions = document.getElementById('answer-options');
        const feedbackMessage = document.getElementById('feedback-message');

        // --- Question Bank ---
        const allQuestions = [
            // Mavo 3 - §1.3
            {
                topic: "3-1.3",
                question: "Wat hield de 'ethische politiek' van Nederland in Nederlands-Indië in?",
                answers: ["Een plan om de kolonie zo snel mogelijk zelfstandig te maken.", "Het idee dat Nederland moest zorgen voor de mensen in de kolonie, bijvoorbeeld door scholen te bouwen.", "Een plan om zoveel mogelijk winst uit de kolonie te halen.", "Een plan om iedereen te dwingen Nederlands te spreken."],
                correct: 1
            },
            // Mavo 3 - §1.4
            {
                topic: "3-1.4",
                question: "Wat gebeurde er op 17 augustus 1945, kort nadat Japan zich had overgegeven?",
                answers: [ "Soekarno riep de onafhankelijkheid van Indonesië uit.", "Nederland gaf de kolonie vrijwillig terug.", "De 'politionele acties' begonnen.", "De geallieerden namen het bestuur over." ],
                correct: 0
            },
            // Mavo 3 - §2.1
            {
                topic: "3-2.1",
                question: "Hoe was het leven voor een fabrieksarbeider in de 19e eeuw?",
                answers: [ "Korte werkdagen en veel vrije tijd.", "Een goed loon en een mooi huis.", "Lange werkdagen, gevaarlijk werk en weinig loon.", "Verplichte scholing voor hun kinderen." ],
                correct: 2
            },
            // Mavo 3 - §2.2
            {
                topic: "3-2.2",
                question: "Hoe heet de eerste wet tegen kinderarbeid uit 1874?",
                answers: [ "De Arbeidswet", "De Leerplichtwet", "Het Kinderwetje van Van Houten", "De Fabriekswet" ],
                correct: 2
            },
            // Mavo 3 - §2.3
            {
                topic: "3-2.3",
                question: "Waarom kwamen er in de jaren '60 en '70 veel 'gastarbeiders' naar Nederland?",
                answers: ["Om te helpen op het platteland.", "Voor de gezelligheid.", "Omdat er een groot tekort was aan werknemers in de fabrieken.", "Om de Nederlandse taal te leren."],
                correct: 2
            },
            // Mavo 4 - §1.1
            {
                topic: "4-1.1",
                question: "Wat was de belangrijkste verandering in de grondwet van 1848?",
                answers: ["De koning kreeg meer macht.", "De ministers werden verantwoordelijk in plaats van de koning.", "Nederland werd een republiek.", "Iedereen kreeg stemrecht."],
                correct: 1
            },
             {
                topic: "4-1.1",
                question: "Waarom ging koning Willem II akkoord met de nieuwe grondwet van Thorbecke?",
                answers: ["Omdat hij zelf minder wilde werken.", "Omdat de bevolking in opstand kwam.", "Omdat hij bang was voor een revolutie, net als in andere Europese landen.", "Omdat hij geld kreeg van het parlement."],
                correct: 2
            },
            // Mavo 4 - §1.2
            {
                topic: "4-1.2",
                question: "Welke drie grote politieke stromingen ontstonden in de 19e eeuw?",
                answers: ["Liberalisme, socialisme en confessionalisme.", "Democratie, dictatuur en monarchie.", "Kapitalisme, communisme en anarchisme.", "Nationalisme, imperialisme en kolonialisme."],
                correct: 0
            },
            {
                topic: "4-1.2",
                question: "Wat was de 'sociale kwestie'?",
                answers: ["Een discussie over de macht van de koning.", "De slechte woon- en werkomstandigheden van de arbeiders.", "Een ruzie over de koloniën.", "De vraag of vrouwen mochten stemmen."],
                correct: 1
            },
            // Mavo 4 - §1.3
            {
                topic: "4-1.3",
                question: "Wat was het doel van de eerste feministische golf?",
                answers: ["Gelijke lonen voor mannen en vrouwen.", "Het recht op abortus.", "Het recht om te mogen studeren.", "Kiesrecht voor vrouwen."],
                correct: 3
            },
            {
                topic: "4-1.3",
                question: "Wanneer kregen álle mannen in Nederland kiesrecht?",
                answers: ["In 1848", "In 1887", "In 1917", "In 1919"],
                correct: 2
            },
            // Mavo 4 - §1.4
            {
                topic: "4-1.4",
                question: "Waarom moeten politieke partijen in Nederland vaak een coalitie vormen na de verkiezingen?",
                answers: ["Omdat de koning dat wil.", "Omdat er te veel partijen zijn.", "Omdat meestal geen enkele partij een meerderheid van de zetels heeft.", "Omdat dit in de grondwet staat."],
                correct: 2
            },
            {
                topic: "4-1.4",
                question: "Welk recht heeft alleen de Tweede Kamer, en niet de Eerste Kamer?",
                answers: ["Het recht van budget (de begroting goedkeuren).", "Het recht van enquête (een onderzoek instellen).", "Het recht van initiatief (zelf een wetsvoorstel indienen).", "Het recht van interpellatie (de minister om informatie vragen)."],
                correct: 2
            },
            {
                topic: "4-1.4",
                question: "Wat is een belangrijk kenmerk van een rechtsstaat?",
                answers: ["Dat de politie altijd gelijk heeft.", "Dat de overheid en burgers zich beiden aan de wet moeten houden.", "Dat er geen rechters nodig zijn.", "Dat de koning de wetten maakt."],
                correct: 1
            },
            // Mavo 4 - Personen
            {
                topic: "4-personen",
                question: "Welke politicus was de belangrijkste schrijver van de grondwet van 1848?",
                answers: ["Abraham Kuyper", "Johan Thorbecke", "Pieter Jelles Troelstra", "Herman Schaepman"],
                correct: 1
            },
            {
                topic: "4-personen",
                question: "Wie was de eerste vrouw in Nederland die naar de universiteit ging en arts werd?",
                answers: ["Koningin Wilhelmina", "Wilhelmina Drucker", "Koningin Juliana", "Aletta Jacobs"],
                correct: 3
            },
            {
                topic: "4-personen",
                question: "Welke politicus was de leider van de socialisten en richtte de SDAP op?",
                answers: ["Pieter Jelles Troelstra", "Abraham Kuyper", "Johan Thorbecke", "Koning Willem III"],
                correct: 0
            },
            {
                topic: "4-personen",
                question: "Onder welke koning werd de belangrijke grondwet van 1848 ingevoerd?",
                answers: ["Koning Willem I", "Koning Willem II", "Koning Willem III", "Koning Willem-Alexander"],
                correct: 1
            }
        ];

        // --- Game State ---
        let gameState = {};
        let availableQuestions = [];
        let selectedCell = null;
        let lastQuestionServed = null; 

        // --- Functions ---
        
        function shuffleQuestions(questions) {
             availableQuestions = [...questions].sort(() => Math.random() - 0.5);
        }

        function startGameApplication() {
            videoIntroScreen.classList.add('hidden');
            gameContainer.classList.remove('hidden');
        }

        function initializeGame() {
            const selectedCheckboxes = document.querySelectorAll('input[name="topic"]:checked');
            const selectedTopics = Array.from(selectedCheckboxes).map(cb => cb.value);
            
            if (selectedTopics.length === 0) {
                topicError.textContent = "Kies alsjeblieft minstens één onderwerp.";
                return;
            }
            topicError.textContent = "";

            const questionsForGame = allQuestions.filter(q => selectedTopics.includes(q.topic));
            
            gameState = {
                teamBlueName: teamBlueNameInput.value.trim() || 'Blauw',
                teamRedName: teamRedNameInput.value.trim() || 'Rood',
                currentPlayer: 'X',
                board: Array(9).fill(null),
                gameOver: false,
                baseQuestions: questionsForGame 
            };

            playerBlueDisplay.textContent = `${gameState.teamBlueName} (X)`;
            playerRedDisplay.textContent = `${gameState.teamRedName} (O)`;
            
            lastQuestionServed = null;
            shuffleQuestions(gameState.baseQuestions);
            createBoard();
            updateTurnIndicator();
            resultDisplay.classList.add('hidden');

            setupScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
        }

        function createBoard() {
            gameBoard.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.classList.add('board-cell', 'flex', 'items-center', 'justify-center', 'cursor-pointer', 'rounded-md', 'aspect-square');
                cell.dataset.index = i;
                cell.addEventListener('click', handleCellClick);
                gameBoard.appendChild(cell);
            }
        }

        function updateTurnIndicator() {
            if(gameState.gameOver) return;
            const currentTeamName = gameState.currentPlayer === 'X' ? gameState.teamBlueName : gameState.teamRedName;
            turnIndicator.textContent = `${currentTeamName} is aan de beurt`;
            if (gameState.currentPlayer === 'X') {
                turnIndicator.style.borderColor = '#22d3ee';
                turnIndicator.style.color = '#22d3ee';
            } else {
                turnIndicator.style.borderColor = '#f87171';
                turnIndicator.style.color = '#f87171';
            }
        }

        function handleCellClick(event) {
            if (gameState.gameOver) return;
            const targetCell = event.target.closest('.board-cell');
            if (!targetCell) return;
            selectedCell = targetCell;
            const index = selectedCell.dataset.index;
            if (gameState.board[index]) return; 
            showQuestion();
        }

        function showQuestion() {
            if (availableQuestions.length === 0) {
                shuffleQuestions(gameState.baseQuestions);
            }
            if (availableQuestions.length > 1 && availableQuestions[availableQuestions.length - 1] === lastQuestionServed) {
                const lastIndex = availableQuestions.length - 1;
                [availableQuestions[lastIndex], availableQuestions[lastIndex - 1]] = [availableQuestions[lastIndex - 1], availableQuestions[lastIndex]];
            }
            const questionData = availableQuestions.pop();
            lastQuestionServed = questionData; 
            gameState.currentQuestion = questionData;

            questionText.textContent = questionData.question;
            answerOptions.innerHTML = '';

            questionData.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.textContent = answer;
                button.classList.add('p-4', 'border-2', 'border-gray-600', 'bg-gray-700', 'rounded-md', 'text-left', 'hover:bg-gray-600', 'hover:border-cyan-400', 'transition', 'text-gray-300');
                button.dataset.index = index;
                button.addEventListener('click', handleAnswer);
                answerOptions.appendChild(button);
            });
            
            feedbackMessage.textContent = '';
            questionModal.classList.add('active');
        }
        
        function handleAnswer(event) {
            const selectedIndex = parseInt(event.target.dataset.index);
            const isCorrect = selectedIndex === gameState.currentQuestion.correct;
            
            const buttons = answerOptions.querySelectorAll('button');
            buttons.forEach(button => {
                button.disabled = true;
                button.classList.remove('hover:bg-gray-600', 'hover:border-cyan-400');
            });
            
            buttons.forEach((button, index) => {
                if (index === gameState.currentQuestion.correct) {
                    button.classList.remove('bg-gray-700', 'border-gray-600');
                    button.classList.add('bg-green-500', 'border-green-400', 'text-white');
                } else if (index === selectedIndex && !isCorrect) {
                     button.classList.remove('bg-gray-700', 'border-gray-600');
                    button.classList.add('bg-red-500', 'border-red-400', 'text-white');
                }
            });

            if (isCorrect) {
                feedbackMessage.textContent = "Correct! Je mag je symbool plaatsen.";
                feedbackMessage.classList.remove('text-red-400');
                feedbackMessage.classList.add('text-green-400');
                setTimeout(() => {
                    placeSymbol(selectedCell);
                    questionModal.classList.remove('active');
                }, 1500);
            } else {
                feedbackMessage.textContent = "Helaas, de beurt gaat naar de ander.";
                feedbackMessage.classList.remove('text-green-400');
                feedbackMessage.classList.add('text-red-400');
                setTimeout(() => {
                    switchPlayer();
                    questionModal.classList.remove('active');
                }, 2000);
            }
        }

        function placeSymbol(cell) {
             const index = cell.dataset.index;
             gameState.board[index] = gameState.currentPlayer;
             const symbol = document.createElement('span');
             symbol.textContent = gameState.currentPlayer;
             symbol.classList.add(gameState.currentPlayer === 'X' ? 'x-symbol' : 'o-symbol');
             cell.innerHTML = '';
             cell.appendChild(symbol);
             cell.classList.add('occupied');
             cell.removeEventListener('click', handleCellClick);
             const winningCombination = checkWin();
             if (winningCombination) {
                endGame(false, winningCombination);
             } else if (checkDraw()) {
                endGame(true, null);
             } else {
                switchPlayer();
             }
        }

        function switchPlayer() {
            gameState.currentPlayer = gameState.currentPlayer === 'X' ? 'O' : 'X';
            updateTurnIndicator();
        }

        function checkWin() {
            const winConditions = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]
            ];
            for (let i = 0; i < winConditions.length; i++) {
                const combination = winConditions[i];
                const [a, b, c] = combination;
                if (gameState.board[a] && gameState.board[a] === gameState.board[b] && gameState.board[a] === gameState.board[c]) {
                    return combination;
                }
            }
            return null;
        }

        function checkDraw() {
            return gameState.board.every(cell => cell !== null);
        }

        function endGame(draw, winningCombination) {
            gameState.gameOver = true;
            if (draw) {
                resultMessage.textContent = "Gelijkspel!";
                turnIndicator.textContent = "Spel voorbij";
            } else {
                const winnerName = gameState.currentPlayer === 'X' ? gameState.teamBlueName : gameState.teamRedName;
                resultMessage.textContent = `${winnerName} wint!`;
                turnIndicator.textContent = "Spel voorbij";
                winningCombination.forEach(index => {
                    gameBoard.children[index].classList.add('winning-cell');
                });
            }
            resultDisplay.classList.remove('hidden');
        }

        function resetGame() {
            gameState.board = Array(9).fill(null);
            gameState.gameOver = false;
            gameState.currentPlayer = 'X';
            lastQuestionServed = null;
            shuffleQuestions(gameState.baseQuestions);
            createBoard();
            updateTurnIndicator();
            resultDisplay.classList.add('hidden');
        }

        // --- Event Listeners ---
        introVideo.addEventListener('ended', startGameApplication);
        skipIntroBtn.addEventListener('click', startGameApplication);
        startGameBtn.addEventListener('click', initializeGame);
        playAgainBtn.addEventListener('click', resetGame);

    </script>
</body>
</html>

